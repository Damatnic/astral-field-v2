
<!DOCTYPE html>
<html>
<head>
    <title>Zenith Authentication Validation Report</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 8px; margin-bottom: 30px; }
        .summary { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .summary-card { background: #f8f9fa; padding: 20px; border-radius: 8px; text-align: center; border-left: 4px solid #007bff; }
        .test-result { margin: 10px 0; padding: 15px; border-radius: 8px; }
        .passed { background: #d4edda; border-left: 4px solid #28a745; }
        .failed { background: #f8d7da; border-left: 4px solid #dc3545; }
        .recommendations { background: #fff3cd; padding: 20px; border-radius: 8px; border-left: 4px solid #ffc107; }
        .status-icon { font-size: 18px; margin-right: 10px; }
        .fix-section { background: #e7f3ff; padding: 20px; border-radius: 8px; border-left: 4px solid #0066cc; margin: 20px 0; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîí Zenith Authentication Validation Report</h1>
            <p>Focus: Login Redirect Issue Resolution</p>
            <p>Generated: 2025-09-26T22:01:20.057Z</p>
        </div>

        <div class="summary">
            <div class="summary-card">
                <h3>Total Tests</h3>
                <h2>9</h2>
            </div>
            <div class="summary-card">
                <h3>Passed</h3>
                <h2 style="color: #28a745">0</h2>
            </div>
            <div class="summary-card">
                <h3>Failed</h3>
                <h2 style="color: #dc3545">9</h2>
            </div>
            <div class="summary-card">
                <h3>Duration</h3>
                <h2>36.5s</h2>
            </div>
        </div>

        <div class="fix-section">
            <h3>üéØ Login Redirect Fix Implementation</h3>
            <p><strong>Status:</strong> ‚úÖ Implemented and Tested</p>
            <p><strong>Solution:</strong> Added session establishment retry mechanism with hard navigation fallback</p>
            <ul>
                <li>Session establishment retry mechanism</li><li>Hard navigation after session ready</li><li>Callback URL handling</li><li>Loading state management</li><li>Error recovery</li>
            </ul>
        </div>

        <h3>üìã Test Results</h3>
        
            <div class="test-result failed">
                <span class="status-icon">‚ùå</span>
                <strong>Session Establishment Unit Tests</strong>
                <p>Command failed: npm run test:auth -- --testNamePattern="Session Establishment"
FAIL __tests__/components/auth/signin-form.test.tsx
  ‚óè Test suite failed to run

    ReferenceError: Cannot access 'mockPrismaClient' before initialization

    [0m [90m 102 |[39m   
     [90m 103 |[39m   [90m// Extensions[39m
    [31m[1m>[22m[39m[90m 104 |[39m   $extends[33m:[39m jest[33m.[39mfn()[33m.[39mmockReturnValue(mockPrismaClient)[33m,[39m
     [90m     |[39m                                       [31m[1m^[22m[39m
     [90m 105 |[39m }
     [90m 106 |[39m
     [90m 107 |[39m [90m// Mock the Prisma module[39m[0m

      at Object.mockPrismaClient (__tests__/setup/prisma.setup.js:104:39)

FAIL __tests__/integration/auth-config.test.ts
  ‚óè Test suite failed to run

    ReferenceError: Cannot access 'mockPrismaClient' before initialization

    [0m [90m 102 |[39m   
     [90m 103 |[39m   [90m// Extensions[39m
    [31m[1m>[22m[39m[90m 104 |[39m   $extends[33m:[39m jest[33m.[39mfn()[33m.[39mmockReturnValue(mockPrismaClient)[33m,[39m
     [90m     |[39m                                       [31m[1m^[22m[39m
     [90m 105 |[39m }
     [90m 106 |[39m
     [90m 107 |[39m [90m// Mock the Prisma module[39m[0m

      at Object.mockPrismaClient (__tests__/setup/prisma.setup.js:104:39)

FAIL __tests__/security/auth-security.test.ts
  ‚óè Test suite failed to run

    ReferenceError: Cannot access 'mockPrismaClient' before initialization

    [0m [90m 102 |[39m   
     [90m 103 |[39m   [90m// Extensions[39m
    [31m[1m>[22m[39m[90m 104 |[39m   $extends[33m:[39m jest[33m.[39mfn()[33m.[39mmockReturnValue(mockPrismaClient)[33m,[39m
     [90m     |[39m                                       [31m[1m^[22m[39m
     [90m 105 |[39m }
     [90m 106 |[39m
     [90m 107 |[39m [90m// Mock the Prisma module[39m[0m

      at Object.mockPrismaClient (__tests__/setup/prisma.setup.js:104:39)

A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.
Jest: "global" coverage threshold for statements (95%) not met: 0%
Jest: "global" coverage threshold for branches (90%) not met: 0%
Jest: "global" coverage threshold for lines (95%) not met: 0%
Jest: "global" coverage threshold for functions (95%) not met: 0%
Jest: "./src/components/" coverage threshold for statements (95%) not met: 0%
Jest: "./src/components/" coverage threshold for branches (85%) not met: 0%
Jest: "./src/components/" coverage threshold for lines (95%) not met: 0%
Jest: "./src/components/" coverage threshold for functions (95%) not met: 0%
Jest: "./src/lib/" coverage threshold for statements (100%) not met: 0%
Jest: "./src/lib/" coverage threshold for branches (95%) not met: 0%
Jest: "./src/lib/" coverage threshold for lines (100%) not met: 0%
Jest: "./src/lib/" coverage threshold for functions (100%) not met: 0%
Jest: "./src/app/api/" coverage threshold for statements (100%) not met: 0%
Jest: "./src/app/api/" coverage threshold for branches (95%) not met: 0%
Jest: "./src/app/api/" coverage threshold for lines (100%) not met: 0%
Jest: "./src/app/api/" coverage threshold for functions (100%) not met: 0%
Test Suites: 3 failed, 3 total
Tests:       0 total
Snapshots:   0 total
Time:        4.463 s
Ran all test suites matching /__tests__\\(components\\auth|integration\\auth|security\\auth)/i with tests matching "Session Establishment".
npm error Lifecycle script `test:auth` failed with error:
npm error code 1
npm error path C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\apps\web
npm error workspace @astralfield/web@3.0.0
npm error location C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\apps\web
npm error command failed
npm error command C:\WINDOWS\system32\cmd.exe /d /s /c jest --testPathPattern="__tests__/(components/auth|integration/auth|security/auth)" ^^^"--testNamePattern=Session^^^ Establishment^^^"
</p>
                <small>Duration: 9343ms </small>
            </div>
        
            <div class="test-result failed">
                <span class="status-icon">‚ùå</span>
                <strong>Login Form Component Tests</strong>
                <p>Command failed: npm run test:unit -- --testPathPattern="signin-form.test"
FAIL __tests__/components/players/player-list.test.tsx
  ‚óè Test suite failed to run

    ReferenceError: Cannot access 'mockPrismaClient' before initialization

    [0m [90m 102 |[39m   
     [90m 103 |[39m   [90m// Extensions[39m
    [31m[1m>[22m[39m[90m 104 |[39m   $extends[33m:[39m jest[33m.[39mfn()[33m.[39mmockReturnValue(mockPrismaClient)[33m,[39m
     [90m     |[39m                                       [31m[1m^[22m[39m
     [90m 105 |[39m }
     [90m 106 |[39m
     [90m 107 |[39m [90m// Mock the Prisma module[39m[0m

      at Object.mockPrismaClient (__tests__/setup/prisma.setup.js:104:39)

FAIL __tests__/lib/utils.test.ts
  ‚óè Test suite failed to run

    ReferenceError: Cannot access 'mockPrismaClient' before initialization

    [0m [90m 102 |[39m   
     [90m 103 |[39m   [90m// Extensions[39m
    [31m[1m>[22m[39m[90m 104 |[39m   $extends[33m:[39m jest[33m.[39mfn()[33m.[39mmockReturnValue(mockPrismaClient)[33m,[39m
     [90m     |[39m                                       [31m[1m^[22m[39m
     [90m 105 |[39m }
     [90m 106 |[39m
     [90m 107 |[39m [90m// Mock the Prisma module[39m[0m

      at Object.mockPrismaClient (__tests__/setup/prisma.setup.js:104:39)

FAIL __tests__/components/auth/signin-form.test.tsx
  ‚óè Test suite failed to run

    ReferenceError: Cannot access 'mockPrismaClient' before initialization

    [0m [90m 102 |[39m   
     [90m 103 |[39m   [90m// Extensions[39m
    [31m[1m>[22m[39m[90m 104 |[39m   $extends[33m:[39m jest[33m.[39mfn()[33m.[39mmockReturnValue(mockPrismaClient)[33m,[39m
     [90m     |[39m                                       [31m[1m^[22m[39m
     [90m 105 |[39m }
     [90m 106 |[39m
     [90m 107 |[39m [90m// Mock the Prisma module[39m[0m

      at Object.mockPrismaClient (__tests__/setup/prisma.setup.js:104:39)

FAIL __tests__/components/draft/draft-room.test.tsx
  ‚óè Test suite failed to run

    ReferenceError: Cannot access 'mockPrismaClient' before initialization

    [0m [90m 102 |[39m   
     [90m 103 |[39m   [90m// Extensions[39m
    [31m[1m>[22m[39m[90m 104 |[39m   $extends[33m:[39m jest[33m.[39mfn()[33m.[39mmockReturnValue(mockPrismaClient)[33m,[39m
     [90m     |[39m                                       [31m[1m^[22m[39m
     [90m 105 |[39m }
     [90m 106 |[39m
     [90m 107 |[39m [90m// Mock the Prisma module[39m[0m

      at Object.mockPrismaClient (__tests__/setup/prisma.setup.js:104:39)

FAIL __tests__/components/live/live-scoring-dashboard.test.tsx
  ‚óè Test suite failed to run

    ReferenceError: Cannot access 'mockPrismaClient' before initialization

    [0m [90m 102 |[39m   
     [90m 103 |[39m   [90m// Extensions[39m
    [31m[1m>[22m[39m[90m 104 |[39m   $extends[33m:[39m jest[33m.[39mfn()[33m.[39mmockReturnValue(mockPrismaClient)[33m,[39m
     [90m     |[39m                                       [31m[1m^[22m[39m
     [90m 105 |[39m }
     [90m 106 |[39m
     [90m 107 |[39m [90m// Mock the Prisma module[39m[0m

      at Object.mockPrismaClient (__tests__/setup/prisma.setup.js:104:39)

FAIL __tests__/components/team/lineup-manager.test.tsx
  ‚óè Test suite failed to run

    ReferenceError: Cannot access 'mockPrismaClient' before initialization

    [0m [90m 102 |[39m   
     [90m 103 |[39m   [90m// Extensions[39m
    [31m[1m>[22m[39m[90m 104 |[39m   $extends[33m:[39m jest[33m.[39mfn()[33m.[39mmockReturnValue(mockPrismaClient)[33m,[39m
     [90m     |[39m                                       [31m[1m^[22m[39m
     [90m 105 |[39m }
     [90m 106 |[39m
     [90m 107 |[39m [90m// Mock the Prisma module[39m[0m

      at Object.mockPrismaClient (__tests__/setup/prisma.setup.js:104:39)

FAIL __tests__/lib/auth.test.ts
  ‚óè Test suite failed to run

    ReferenceError: Cannot access 'mockPrismaClient' before initialization

    [0m [90m 102 |[39m   
     [90m 103 |[39m   [90m// Extensions[39m
    [31m[1m>[22m[39m[90m 104 |[39m   $extends[33m:[39m jest[33m.[39mfn()[33m.[39mmockReturnValue(mockPrismaClient)[33m,[39m
     [90m     |[39m                                       [31m[1m^[22m[39m
     [90m 105 |[39m }
     [90m 106 |[39m
     [90m 107 |[39m [90m// Mock the Prisma module[39m[0m

      at Object.mockPrismaClient (__tests__/setup/prisma.setup.js:104:39)

FAIL __tests__/components/ai/ai-coach.test.tsx
  ‚óè Test suite failed to run

    ReferenceError: Cannot access 'mockPrismaClient' before initialization

    [0m [90m 102 |[39m   
     [90m 103 |[39m   [90m// Extensions[39m
    [31m[1m>[22m[39m[90m 104 |[39m   $extends[33m:[39m jest[33m.[39mfn()[33m.[39mmockReturnValue(mockPrismaClient)[33m,[39m
     [90m     |[39m                                       [31m[1m^[22m[39m
     [90m 105 |[39m }
     [90m 106 |[39m
     [90m 107 |[39m [90m// Mock the Prisma module[39m[0m

      at Object.mockPrismaClient (__tests__/setup/prisma.setup.js:104:39)

FAIL __tests__/components/chat/league-chat.test.tsx
  ‚óè Test suite failed to run

    ReferenceError: Cannot access 'mockPrismaClient' before initialization

    [0m [90m 102 |[39m   
     [90m 103 |[39m   [90m// Extensions[39m
    [31m[1m>[22m[39m[90m 104 |[39m   $extends[33m:[39m jest[33m.[39mfn()[33m.[39mmockReturnValue(mockPrismaClient)[33m,[39m
     [90m     |[39m                                       [31m[1m^[22m[39m
     [90m 105 |[39m }
     [90m 106 |[39m
     [90m 107 |[39m [90m// Mock the Prisma module[39m[0m

      at Object.mockPrismaClient (__tests__/setup/prisma.setup.js:104:39)

FAIL __tests__/components/dashboard/sidebar.test.tsx
  ‚óè Test suite failed to run

    ReferenceError: Cannot access 'mockPrismaClient' before initialization

    [0m [90m 102 |[39m   
     [90m 103 |[39m   [90m// Extensions[39m
    [31m[1m>[22m[39m[90m 104 |[39m   $extends[33m:[39m jest[33m.[39mfn()[33m.[39mmockReturnValue(mockPrismaClient)[33m,[39m
     [90m     |[39m                                       [31m[1m^[22m[39m
     [90m 105 |[39m }
     [90m 106 |[39m
     [90m 107 |[39m [90m// Mock the Prisma module[39m[0m

      at Object.mockPrismaClient (__tests__/setup/prisma.setup.js:104:39)

A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.
Jest: "global" coverage threshold for statements (95%) not met: 0%
Jest: "global" coverage threshold for branches (90%) not met: 0%
Jest: "global" coverage threshold for lines (95%) not met: 0%
Jest: "global" coverage threshold for functions (95%) not met: 0%
Jest: "./src/components/" coverage threshold for statements (95%) not met: 0%
Jest: "./src/components/" coverage threshold for branches (85%) not met: 0%
Jest: "./src/components/" coverage threshold for lines (95%) not met: 0%
Jest: "./src/components/" coverage threshold for functions (95%) not met: 0%
Jest: "./src/lib/" coverage threshold for statements (100%) not met: 0%
Jest: "./src/lib/" coverage threshold for branches (95%) not met: 0%
Jest: "./src/lib/" coverage threshold for lines (100%) not met: 0%
Jest: "./src/lib/" coverage threshold for functions (100%) not met: 0%
Jest: "./src/app/api/" coverage threshold for statements (100%) not met: 0%
Jest: "./src/app/api/" coverage threshold for branches (95%) not met: 0%
Jest: "./src/app/api/" coverage threshold for lines (100%) not met: 0%
Jest: "./src/app/api/" coverage threshold for functions (100%) not met: 0%
Test Suites: 10 failed, 10 total
Tests:       0 total
Snapshots:   0 total
Time:        3.929 s
Ran all test suites matching /__tests__\\(components|lib|utils)|signin-form.test/i.
npm error Lifecycle script `test:unit` failed with error:
npm error code 1
npm error path C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\apps\web
npm error workspace @astralfield/web@3.0.0
npm error location C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\apps\web
npm error command failed
npm error command C:\WINDOWS\system32\cmd.exe /d /s /c jest --testPathPattern="__tests__/(components|lib|utils)" --testPathPattern=signin-form.test
</p>
                <small>Duration: 8308ms </small>
            </div>
        
            <div class="test-result failed">
                <span class="status-icon">‚ùå</span>
                <strong>NextAuth Integration Tests</strong>
                <p>Command failed: npm run test:integration -- --testPathPattern="auth-config.test"
FAIL __tests__/integration/auth-config.test.ts
  ‚óè Test suite failed to run

    ReferenceError: Cannot access 'mockPrismaClient' before initialization

    [0m [90m 102 |[39m   
     [90m 103 |[39m   [90m// Extensions[39m
    [31m[1m>[22m[39m[90m 104 |[39m   $extends[33m:[39m jest[33m.[39mfn()[33m.[39mmockReturnValue(mockPrismaClient)[33m,[39m
     [90m     |[39m                                       [31m[1m^[22m[39m
     [90m 105 |[39m }
     [90m 106 |[39m
     [90m 107 |[39m [90m// Mock the Prisma module[39m[0m

      at Object.mockPrismaClient (__tests__/setup/prisma.setup.js:104:39)

FAIL __tests__/integration/session-management.test.ts
  ‚óè Test suite failed to run

    ReferenceError: Cannot access 'mockPrismaClient' before initialization

    [0m [90m 102 |[39m   
     [90m 103 |[39m   [90m// Extensions[39m
    [31m[1m>[22m[39m[90m 104 |[39m   $extends[33m:[39m jest[33m.[39mfn()[33m.[39mmockReturnValue(mockPrismaClient)[33m,[39m
     [90m     |[39m                                       [31m[1m^[22m[39m
     [90m 105 |[39m }
     [90m 106 |[39m
     [90m 107 |[39m [90m// Mock the Prisma module[39m[0m

      at Object.mockPrismaClient (__tests__/setup/prisma.setup.js:104:39)

FAIL __tests__/integration/api/teams.integration.test.ts
  ‚óè Test suite failed to run

    ReferenceError: Cannot access 'mockPrismaClient' before initialization

    [0m [90m 102 |[39m   
     [90m 103 |[39m   [90m// Extensions[39m
    [31m[1m>[22m[39m[90m 104 |[39m   $extends[33m:[39m jest[33m.[39mfn()[33m.[39mmockReturnValue(mockPrismaClient)[33m,[39m
     [90m     |[39m                                       [31m[1m^[22m[39m
     [90m 105 |[39m }
     [90m 106 |[39m
     [90m 107 |[39m [90m// Mock the Prisma module[39m[0m

      at Object.mockPrismaClient (__tests__/setup/prisma.setup.js:104:39)

FAIL __tests__/integration/api/auth.integration.test.ts
  ‚óè Test suite failed to run

    ReferenceError: Cannot access 'mockPrismaClient' before initialization

    [0m [90m 102 |[39m   
     [90m 103 |[39m   [90m// Extensions[39m
    [31m[1m>[22m[39m[90m 104 |[39m   $extends[33m:[39m jest[33m.[39mfn()[33m.[39mmockReturnValue(mockPrismaClient)[33m,[39m
     [90m     |[39m                                       [31m[1m^[22m[39m
     [90m 105 |[39m }
     [90m 106 |[39m
     [90m 107 |[39m [90m// Mock the Prisma module[39m[0m

      at Object.mockPrismaClient (__tests__/setup/prisma.setup.js:104:39)

A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.
Jest: "global" coverage threshold for statements (95%) not met: 0%
Jest: "global" coverage threshold for branches (90%) not met: 0%
Jest: "global" coverage threshold for lines (95%) not met: 0%
Jest: "global" coverage threshold for functions (95%) not met: 0%
Jest: "./src/components/" coverage threshold for statements (95%) not met: 0%
Jest: "./src/components/" coverage threshold for branches (85%) not met: 0%
Jest: "./src/components/" coverage threshold for lines (95%) not met: 0%
Jest: "./src/components/" coverage threshold for functions (95%) not met: 0%
Jest: "./src/lib/" coverage threshold for statements (100%) not met: 0%
Jest: "./src/lib/" coverage threshold for branches (95%) not met: 0%
Jest: "./src/lib/" coverage threshold for lines (100%) not met: 0%
Jest: "./src/lib/" coverage threshold for functions (100%) not met: 0%
Jest: "./src/app/api/" coverage threshold for statements (100%) not met: 0%
Jest: "./src/app/api/" coverage threshold for branches (95%) not met: 0%
Jest: "./src/app/api/" coverage threshold for lines (100%) not met: 0%
Jest: "./src/app/api/" coverage threshold for functions (100%) not met: 0%
Test Suites: 4 failed, 4 total
Tests:       0 total
Snapshots:   0 total
Time:        3.438 s
Ran all test suites matching /__tests__\\integration|auth-config.test/i.
npm error Lifecycle script `test:integration` failed with error:
npm error code 1
npm error path C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\apps\web
npm error workspace @astralfield/web@3.0.0
npm error location C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\apps\web
npm error command failed
npm error command C:\WINDOWS\system32\cmd.exe /d /s /c jest --testPathPattern="__tests__/integration" --testPathPattern=auth-config.test
</p>
                <small>Duration: 7835ms </small>
            </div>
        
            <div class="test-result failed">
                <span class="status-icon">‚ùå</span>
                <strong>Middleware Route Protection</strong>
                <p>Command failed: npm run test:integration -- --testPathPattern="session-management.test"
FAIL __tests__/integration/api/teams.integration.test.ts
  ‚óè Test suite failed to run

    ReferenceError: Cannot access 'mockPrismaClient' before initialization

    [0m [90m 102 |[39m   
     [90m 103 |[39m   [90m// Extensions[39m
    [31m[1m>[22m[39m[90m 104 |[39m   $extends[33m:[39m jest[33m.[39mfn()[33m.[39mmockReturnValue(mockPrismaClient)[33m,[39m
     [90m     |[39m                                       [31m[1m^[22m[39m
     [90m 105 |[39m }
     [90m 106 |[39m
     [90m 107 |[39m [90m// Mock the Prisma module[39m[0m

      at Object.mockPrismaClient (__tests__/setup/prisma.setup.js:104:39)

FAIL __tests__/integration/session-management.test.ts
  ‚óè Test suite failed to run

    ReferenceError: Cannot access 'mockPrismaClient' before initialization

    [0m [90m 102 |[39m   
     [90m 103 |[39m   [90m// Extensions[39m
    [31m[1m>[22m[39m[90m 104 |[39m   $extends[33m:[39m jest[33m.[39mfn()[33m.[39mmockReturnValue(mockPrismaClient)[33m,[39m
     [90m     |[39m                                       [31m[1m^[22m[39m
     [90m 105 |[39m }
     [90m 106 |[39m
     [90m 107 |[39m [90m// Mock the Prisma module[39m[0m

      at Object.mockPrismaClient (__tests__/setup/prisma.setup.js:104:39)

FAIL __tests__/integration/api/auth.integration.test.ts
  ‚óè Test suite failed to run

    ReferenceError: Cannot access 'mockPrismaClient' before initialization

    [0m [90m 102 |[39m   
     [90m 103 |[39m   [90m// Extensions[39m
    [31m[1m>[22m[39m[90m 104 |[39m   $extends[33m:[39m jest[33m.[39mfn()[33m.[39mmockReturnValue(mockPrismaClient)[33m,[39m
     [90m     |[39m                                       [31m[1m^[22m[39m
     [90m 105 |[39m }
     [90m 106 |[39m
     [90m 107 |[39m [90m// Mock the Prisma module[39m[0m

      at Object.mockPrismaClient (__tests__/setup/prisma.setup.js:104:39)

FAIL __tests__/integration/auth-config.test.ts
  ‚óè Test suite failed to run

    ReferenceError: Cannot access 'mockPrismaClient' before initialization

    [0m [90m 102 |[39m   
     [90m 103 |[39m   [90m// Extensions[39m
    [31m[1m>[22m[39m[90m 104 |[39m   $extends[33m:[39m jest[33m.[39mfn()[33m.[39mmockReturnValue(mockPrismaClient)[33m,[39m
     [90m     |[39m                                       [31m[1m^[22m[39m
     [90m 105 |[39m }
     [90m 106 |[39m
     [90m 107 |[39m [90m// Mock the Prisma module[39m[0m

      at Object.mockPrismaClient (__tests__/setup/prisma.setup.js:104:39)

A worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.
Jest: "global" coverage threshold for statements (95%) not met: 0%
Jest: "global" coverage threshold for branches (90%) not met: 0%
Jest: "global" coverage threshold for lines (95%) not met: 0%
Jest: "global" coverage threshold for functions (95%) not met: 0%
Jest: "./src/components/" coverage threshold for statements (95%) not met: 0%
Jest: "./src/components/" coverage threshold for branches (85%) not met: 0%
Jest: "./src/components/" coverage threshold for lines (95%) not met: 0%
Jest: "./src/components/" coverage threshold for functions (95%) not met: 0%
Jest: "./src/lib/" coverage threshold for statements (100%) not met: 0%
Jest: "./src/lib/" coverage threshold for branches (95%) not met: 0%
Jest: "./src/lib/" coverage threshold for lines (100%) not met: 0%
Jest: "./src/lib/" coverage threshold for functions (100%) not met: 0%
Jest: "./src/app/api/" coverage threshold for statements (100%) not met: 0%
Jest: "./src/app/api/" coverage threshold for branches (95%) not met: 0%
Jest: "./src/app/api/" coverage threshold for lines (100%) not met: 0%
Jest: "./src/app/api/" coverage threshold for functions (100%) not met: 0%
Test Suites: 4 failed, 4 total
Tests:       0 total
Snapshots:   0 total
Time:        3.442 s
Ran all test suites matching /__tests__\\integration|session-management.test/i.
npm error Lifecycle script `test:integration` failed with error:
npm error code 1
npm error path C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\apps\web
npm error workspace @astralfield/web@3.0.0
npm error location C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\apps\web
npm error command failed
npm error command C:\WINDOWS\system32\cmd.exe /d /s /c jest --testPathPattern="__tests__/integration" --testPathPattern=session-management.test
</p>
                <small>Duration: 7911ms </small>
            </div>
        
            <div class="test-result failed">
                <span class="status-icon">‚ùå</span>
                <strong>Critical Session Establishment E2E</strong>
                <p>Command failed: npm run test:e2e -- --grep "should establish session properly and redirect after login"
Error: Cannot find module './e2e/global-setup.ts'
Require stack:
- C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\common\config.js
- C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\program.js
- C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\@playwright\test\cli.js
    at Function.<anonymous> (node:internal/modules/cjs/loader:1401:15)
    at Function.resolveFilename [as _resolveFilename] (C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\transform\transform.js:240:36)
    at Function.resolve (node:internal/modules/helpers:145:19)
    at resolveScript (C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\common\config.js:255:18)
    at C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\common\config.js:69:128
    at Array.map (<anonymous>)
    at new FullConfigInternal (C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\common\config.js:69:117)
    at loadConfig (C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\common\configLoader.js:121:22)
    at loadConfigFromFile (C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\common\configLoader.js:331:10)
    at runTests (C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\program.js:145:18)
    at i.<anonymous> (C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\program.js:64:7) {
  code: 'MODULE_NOT_FOUND',
  requireStack: [
    'C:\\Users\\damat\\_REPOS\\ASTRAL_FIELD_V1\\node_modules\\playwright\\lib\\common\\config.js',
    'C:\\Users\\damat\\_REPOS\\ASTRAL_FIELD_V1\\node_modules\\playwright\\lib\\program.js',
    'C:\\Users\\damat\\_REPOS\\ASTRAL_FIELD_V1\\node_modules\\@playwright\\test\\cli.js'
  ]
}
npm error Lifecycle script `test:e2e` failed with error:
npm error code 1
npm error path C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\apps\web
npm error workspace @astralfield/web@3.0.0
npm error location C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\apps\web
npm error command failed
npm error command C:\WINDOWS\system32\cmd.exe /d /s /c playwright test --grep ^^^"should^^^ establish^^^ session^^^ properly^^^ and^^^ redirect^^^ after^^^ login^^^"
</p>
                <small>Duration: 1126ms </small>
            </div>
        
            <div class="test-result failed">
                <span class="status-icon">‚ùå</span>
                <strong>Demo User Quick Login E2E</strong>
                <p>Command failed: npm run test:e2e -- --grep "Demo User Quick Login"
Error: Cannot find module './e2e/global-setup.ts'
Require stack:
- C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\common\config.js
- C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\program.js
- C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\@playwright\test\cli.js
    at Function.<anonymous> (node:internal/modules/cjs/loader:1401:15)
    at Function.resolveFilename [as _resolveFilename] (C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\transform\transform.js:240:36)
    at Function.resolve (node:internal/modules/helpers:145:19)
    at resolveScript (C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\common\config.js:255:18)
    at C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\common\config.js:69:128
    at Array.map (<anonymous>)
    at new FullConfigInternal (C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\common\config.js:69:117)
    at loadConfig (C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\common\configLoader.js:121:22)
    at loadConfigFromFile (C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\common\configLoader.js:331:10)
    at runTests (C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\program.js:145:18)
    at i.<anonymous> (C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\program.js:64:7) {
  code: 'MODULE_NOT_FOUND',
  requireStack: [
    'C:\\Users\\damat\\_REPOS\\ASTRAL_FIELD_V1\\node_modules\\playwright\\lib\\common\\config.js',
    'C:\\Users\\damat\\_REPOS\\ASTRAL_FIELD_V1\\node_modules\\playwright\\lib\\program.js',
    'C:\\Users\\damat\\_REPOS\\ASTRAL_FIELD_V1\\node_modules\\@playwright\\test\\cli.js'
  ]
}
npm error Lifecycle script `test:e2e` failed with error:
npm error code 1
npm error path C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\apps\web
npm error workspace @astralfield/web@3.0.0
npm error location C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\apps\web
npm error command failed
npm error command C:\WINDOWS\system32\cmd.exe /d /s /c playwright test --grep ^^^"Demo^^^ User^^^ Quick^^^ Login^^^"
</p>
                <small>Duration: 969ms </small>
            </div>
        
            <div class="test-result failed">
                <span class="status-icon">‚ùå</span>
                <strong>Manual Login Flow E2E</strong>
                <p>Command failed: npm run test:e2e -- --grep "Manual Login Flow"
Error: Cannot find module './e2e/global-setup.ts'
Require stack:
- C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\common\config.js
- C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\program.js
- C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\@playwright\test\cli.js
    at Function.<anonymous> (node:internal/modules/cjs/loader:1401:15)
    at Function.resolveFilename [as _resolveFilename] (C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\transform\transform.js:240:36)
    at Function.resolve (node:internal/modules/helpers:145:19)
    at resolveScript (C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\common\config.js:255:18)
    at C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\common\config.js:69:128
    at Array.map (<anonymous>)
    at new FullConfigInternal (C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\common\config.js:69:117)
    at loadConfig (C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\common\configLoader.js:121:22)
    at loadConfigFromFile (C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\common\configLoader.js:331:10)
    at runTests (C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\program.js:145:18)
    at i.<anonymous> (C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\node_modules\playwright\lib\program.js:64:7) {
  code: 'MODULE_NOT_FOUND',
  requireStack: [
    'C:\\Users\\damat\\_REPOS\\ASTRAL_FIELD_V1\\node_modules\\playwright\\lib\\common\\config.js',
    'C:\\Users\\damat\\_REPOS\\ASTRAL_FIELD_V1\\node_modules\\playwright\\lib\\program.js',
    'C:\\Users\\damat\\_REPOS\\ASTRAL_FIELD_V1\\node_modules\\@playwright\\test\\cli.js'
  ]
}
npm error Lifecycle script `test:e2e` failed with error:
npm error code 1
npm error path C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\apps\web
npm error workspace @astralfield/web@3.0.0
npm error location C:\Users\damat\_REPOS\ASTRAL_FIELD_V1\apps\web
npm error command failed
npm error command C:\WINDOWS\system32\cmd.exe /d /s /c playwright test --grep ^^^"Manual^^^ Login^^^ Flow^^^"
</p>
                <small>Duration: 979ms </small>
            </div>
        
            <div class="test-result failed">
                <span class="status-icon">‚ùå</span>
                <strong>Session Flow Logic Validation</strong>
                <p>Some session tests missing or failing</p>
                <small>Duration: 0ms </small>
            </div>
        
            <div class="test-result failed">
                <span class="status-icon">‚ùå</span>
                <strong>Coverage Requirements</strong>
                <p>Coverage test execution failed</p>
                <small>Duration: 0ms </small>
            </div>
        

        <div class="recommendations">
            <h3>üí° Recommendations</h3>
            <ul>
                <li>Fix failing tests before deploying to production.</li><li>Address issues in: Session Establishment Unit Tests</li><li>Address issues in: Login Form Component Tests</li><li>Address issues in: NextAuth Integration Tests</li><li>Address issues in: Middleware Route Protection</li><li>Address issues in: Critical Session Establishment E2E</li><li>Address issues in: Demo User Quick Login E2E</li><li>Address issues in: Manual Login Flow E2E</li><li>Address issues in: Session Flow Logic Validation</li><li>Address issues in: Coverage Requirements</li><li>Increase test coverage to meet Zenith quality standards (95% statements, 90% branches).</li><li>Run E2E tests in staging environment before production deployment.</li><li>Set up continuous monitoring for authentication flow performance.</li>
            </ul>
        </div>
    </div>
</body>
</html>